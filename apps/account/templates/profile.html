{% extends layout_path %}

{% load static %}
{% load i18n %}

{% block title %}User Profile - xLearning{% endblock %}

{% block vendor_css %}
{{ block.super }}
<link rel="stylesheet" href="{% static 'vendor/libs/aos/aos.css' %}" />
{% endblock vendor_css %}

{% block vendor_js %}
{{ block.super }}
<script src="{% static 'vendor/libs/aos/aos.js' %}"></script>
{% endblock vendor_js %}

{% block page_css %}
{{ block.super }}
<style>
  .profile-section {
    padding: 80px 0;
    background: #f8f9fc;
  }
  
  .profile-card {
    border-radius: 20px;
    overflow: hidden;
    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
    transition: all 0.3s ease;
    margin-bottom: 2rem;
  }
  
  .profile-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.12);
  }
  
  .profile-cover {
    height: 150px;
    background: linear-gradient(135deg, #7367f0 0%, #ab89b6 100%);
    position: relative;
  }
  
  .profile-avatar {
    width: 140px;
    height: 140px;
    border-radius: 50%;
    border: 8px solid #fff;
    background: #fff;
    position: absolute;
    bottom: -70px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 2;
  }
  
  .profile-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 50%;
  }
  
  .profile-content {
    padding: 100px 40px 40px;
    text-align: center;
  }
  
  .profile-name {
    font-size: 32px;
    font-weight: 700;
    margin-bottom: 5px;
    color: #333;
  }
  
  .profile-username {
    font-size: 18px;
    color: #666;
    margin-bottom: 20px;
  }
  
  .profile-badge {
    display: inline-block;
    background: rgba(115, 103, 240, 0.1);
    color: #7367f0;
    padding: 8px 20px;
    border-radius: 30px;
    margin: 0 5px;
    font-weight: 600;
  }
  
  .stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-top: 40px;
  }
  
  .stat-card {
    background: white;
    border-radius: 15px;
    padding: 25px;
    text-align: center;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
    transition: all 0.3s ease;
  }
  
  .stat-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
  }
  
  .stat-icon {
    width: 60px;
    height: 60px;
    background: rgba(115, 103, 240, 0.1);
    color: #7367f0;
    border-radius: 15px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 15px;
    font-size: 28px;
  }
  
  .stat-number {
    font-size: 32px;
    font-weight: 700;
    color: #333;
    margin-bottom: 5px;
  }
  
  .stat-label {
    color: #666;
    font-size: 16px;
  }
  
  .info-card {
    background: white;
    border-radius: 15px;
    padding: 30px;
    margin-bottom: 20px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
  }
  
  .info-row {
    padding: 12px 0;
    border-bottom: 1px solid #eee;
    display: flex;
    align-items: center;
  }
  
  .info-row:last-child {
    border-bottom: none;
  }
  
  .info-icon {
    width: 40px;
    height: 40px;
    background: #f8f9fc;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #7367f0;
    margin-right: 15px;
  }
  
  .info-label {
    font-weight: 600;
    color: #333;
    min-width: 120px;
  }
  
  .info-value {
    color: #666;
  }
  
  .action-button {
    padding: 12px 30px;
    border-radius: 10px;
    font-weight: 600;
    transition: all 0.3s ease;
  }
  
  .action-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(115, 103, 240, 0.3);
  }
</style>
{% endblock page_css %}

{% block content %}
<section class="profile-section">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-10">
        <!-- Profile Header -->
        <div class="profile-card" data-aos="fade-up" data-aos-duration="1000">
          <div class="profile-cover">
            <div class="profile-avatar">
              {% if profile_user.profile.profile_image %}
                <img src="{{ profile_user.profile.profile_image.url }}" alt="{{ profile_user.username }}">
              {% else %}
                <div style="width: 100%; height: 100%; background: #7367f0; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 48px; font-weight: bold;">
                  {{ profile_user.username|first|upper }}
                </div>
              {% endif %}
            </div>
          </div>
          
          <div class="profile-content">
            <h2 class="profile-name">{{ profile_user.get_full_name|default:profile_user.username }}</h2>
            <p class="profile-username">@{{ profile_user.username }}</p>
            
            <div class="mb-4">
              <span class="profile-badge">{{ profile_user.get_user_type_display }}</span>
              {% if profile_user.is_verified %}
                <span class="profile-badge" style="background: rgba(40, 199, 111, 0.1); color: #28c76f;">Verified</span>
              {% endif %}
            </div>
            
            <div class="d-flex justify-content-center gap-3">
              {% if request.user == profile_user %}
                <a href="{% url 'account:update_profile' %}" class="btn btn-primary action-button">
                  <i class="ti ti-edit me-2"></i> Edit Profile
                </a>
                <a href="{% url 'account:security_settings' %}" class="btn btn-outline-primary action-button">
                  <i class="ti ti-shield-lock me-2"></i> Security
                </a>
              {% endif %}
            </div>
          </div>
        </div>
        
        <!-- Profile Stats -->
        <div class="stats-grid" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="100">
          {% if profile_user.is_teacher %}
            <div class="stat-card">
              <div class="stat-icon">
                <i class="ti ti-book-2"></i>
              </div>
              <div class="stat-number">{{ taught_courses|default:"0" }}</div>
              <div class="stat-label">Courses Taught</div>
            </div>
            
            <div class="stat-card">
              <div class="stat-icon">
                <i class="ti ti-users"></i>
              </div>
              <div class="stat-number">{{ total_students|default:"0" }}</div>
              <div class="stat-label">Total Students</div>
            </div>
            
            <div class="stat-card">
              <div class="stat-icon">
                <i class="ti ti-clock"></i>
              </div>
              <div class="stat-number">{{ teaching_hours|default:"0" }}</div>
              <div class="stat-label">Teaching Hours</div>
            </div>
          {% else %}
            <div class="stat-card">
              <div class="stat-icon">
                <i class="ti ti-book-2"></i>
              </div>
              <div class="stat-number">{{ enrolled_courses|default:"0" }}</div>
              <div class="stat-label">Enrolled Courses</div>
            </div>
            
            <div class="stat-card">
              <div class="stat-icon">
                <i class="ti ti-checkbox"></i>
              </div>
              <div class="stat-number">{{ completed_lessons|default:"0" }}</div>
              <div class="stat-label">Completed Lessons</div>
            </div>
            
            <div class="stat-card">
              <div class="stat-icon">
                <i class="ti ti-chart-line"></i>
              </div>
              <div class="stat-number">{{ avg_score|default:"0" }}%</div>
              <div class="stat-label">Average Score</div>
            </div>
          {% endif %}
        </div>
        
        <!-- Profile Information -->
        <div class="row mt-5">
          <div class="col-lg-6" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="200">
            <div class="info-card">
              <h5 class="mb-4">Contact Information</h5>
              
              <div class="info-row">
                <div class="info-icon">
                  <i class="ti ti-mail"></i>
                </div>
                <div>
                  <div class="info-label">Email</div>
                  <div class="info-value">{{ profile_user.email }}</div>
                </div>
              </div>
              
              {% if profile_user.profile.phone_number %}
              <div class="info-row">
                <div class="info-icon">
                  <i class="ti ti-phone"></i>
                </div>
                <div>
                  <div class="info-label">Phone</div>
                  <div class="info-value">{{ profile_user.profile.phone_number }}</div>
                </div>
              </div>
              {% endif %}
              
              {% if profile_user.profile.date_of_birth %}
              <div class="info-row">
                <div class="info-icon">
                  <i class="ti ti-calendar"></i>
                </div>
                <div>
                  <div class="info-label">Birth Date</div>
                  <div class="info-value">{{ profile_user.profile.date_of_birth|date:"F j, Y" }}</div>
                </div>
              </div>
              {% endif %}
              
              <div class="info-row">
                <div class="info-icon">
                  <i class="ti ti-clock"></i>
                </div>
                <div>
                  <div class="info-label">Member Since</div>
                  <div class="info-value">{{ profile_user.date_joined|date:"F j, Y" }}</div>
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-lg-6" data-aos="fade-up" data-aos-duration="1000" data-aos-delay="300">
            <div class="info-card">
              <h5 class="mb-4">Language Settings</h5>
              
              {% if profile_user.profile.native_language %}
              <div class="info-row">
                <div class="info-icon">
                  <i class="ti ti-language"></i>
                </div>
                <div>
                  <div class="info-label">Native Language</div>
                  <div class="info-value">{{ profile_user.profile.native_language|title }}</div>
                </div>
              </div>
              {% endif %}
              
              {% if profile_user.profile.learning_language %}
              <div class="info-row">
                <div class="info-icon">
                  <i class="ti ti-target"></i>
                </div>
                <div>
                  <div class="info-label">Learning Language</div>
                  <div class="info-value">{{ profile_user.profile.learning_language|title }}</div>
                </div>
              </div>
              {% endif %}
            </div>
            
            {% if profile_user.profile.bio %}
            <div class="info-card">
              <h5 class="mb-4">About</h5>
              <p class="text-muted">{{ profile_user.profile.bio|linebreaks }}</p>
            </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}

{% block page_js %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Initialize AOS animation
    AOS.init({
      duration: 1000,
      once: true,
      offset: 50
    });
  });
</script>
{% endblock %} 